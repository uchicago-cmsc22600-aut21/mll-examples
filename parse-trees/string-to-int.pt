(Prog (BindFun intToString ((PatVar i))
               (ExpIf (ExpBin (ExpVar i) < (ExpInt 0))
                      (ExpBin (ExpStr "-") ^ (ExpApp (ExpVar intToString) (ExpUn unary - (ExpVar i))))
                      (ExpIf (ExpBin (ExpVar i) == (ExpInt 0)) (ExpStr "0")
                             (ExpIf (ExpBin (ExpVar i) == (ExpInt 1)) (ExpStr "1")
                                    (ExpIf (ExpBin (ExpVar i) == (ExpInt 2)) (ExpStr "2")
                                           (ExpIf (ExpBin (ExpVar i) == (ExpInt 3)) (ExpStr "3")
                                                  (ExpIf (ExpBin (ExpVar i) == (ExpInt 4)) (ExpStr "4")
                                                         (ExpIf (ExpBin (ExpVar i) == (ExpInt 5)) (ExpStr "5")
                                                                (ExpIf (ExpBin (ExpVar i) == (ExpInt 6)) (ExpStr "6")
                                                                       (ExpIf (ExpBin (ExpVar i) == (ExpInt 7))
                                                                              (ExpStr "7")
                                                                              (ExpIf (ExpBin (ExpVar i) == (ExpInt 8))
                                                                                     (ExpStr "8")
                                                                                     (ExpIf (ExpBin (ExpVar i) ==
                                                                                                    (ExpInt 9))
                                                                                            (ExpStr "9")
                                                                                            (ExpBin (ExpApp (ExpVar intToString)
                                                                                                            (ExpBin (ExpVar i)
                                                                                                                    /
                                                                                                                    (ExpInt 10)))
                                                                                                    ^
                                                                                                    (ExpApp (ExpVar intToString)
                                                                                                            (ExpBin (ExpVar i)
                                                                                                                    %
                                                                                                                    (ExpInt 10))))))))))))))))
      (DclData Option (a) (Con None) (Con Some (TyVar a)))
      (BindFun optionToString ((PatVar aToString) (PatVar opt))
               (ExpCase (ExpVar opt)
                        ((RuleCase (PatCon None) (SCOPE () (ExpStr "None"))) (RuleCase (PatCon Some (PatVar x))
                                                                                       (SCOPE ()
                                                                                              (ExpBin (ExpBin (ExpStr "Some(")
                                                                                                              ^
                                                                                                              (ExpApp (ExpVar aToString)
                                                                                                                      (ExpVar x)))
                                                                                                      ^ (ExpStr ")")))))))
      (BindVal (PatVar ord0) (ExpApp (ExpVar sub) (ExpTuple (ExpStr "0") (ExpInt 0))))
      (BindVal (PatVar ord9) (ExpApp (ExpVar sub) (ExpTuple (ExpStr "9") (ExpInt 0))))
      (BindFun charToDigit ((PatVar c))
               (ExpIf (ExpBin (ExpVar ord0) <= (ExpVar c))
                      (ExpIf (ExpBin (ExpVar c) <= (ExpVar ord9))
                             (ExpApp (ExpCon Some) (ExpBin (ExpVar c) - (ExpVar ord0))) (ExpCon None)) (ExpCon None)))
      (BindFun stringToInt ((PatVar s))
               (SCOPE ((BindVal (PatVar sz) (ExpApp (ExpVar size) (ExpVar s))) (BindFun loop
                                                                                        ((PatTuple (PatVar pos)
                                                                                                   (PatVar acc)))
                                                                                        (ExpIf (ExpBin (ExpVar pos) <
                                                                                                       (ExpVar sz))
                                                                                               (ExpCase (ExpApp (ExpVar charToDigit)
                                                                                                                (ExpApp (ExpVar sub)
                                                                                                                       (ExpTuple (ExpVar s)
                                                                                                                       (ExpVar pos))))
                                                                                                        ((RuleCase (PatCon None)
                                                                                                                   (SCOPE ()
                                                                                                                       (ExpCon None))) (RuleCase (PatCon Some
                                                                                                                       (PatVar i))
                                                                                                                       (SCOPE ()
                                                                                                                       (ExpApp (ExpVar loop)
                                                                                                                       (ExpTuple (ExpBin (ExpVar pos)
                                                                                                                       +
                                                                                                                       (ExpInt 1))
                                                                                                                       (ExpBin (ExpBin (ExpVar acc)
                                                                                                                       *
                                                                                                                       (ExpInt 10))
                                                                                                                       +
                                                                                                                       (ExpVar i))))))))
                                                                                               (ExpApp (ExpCon Some)
                                                                                                       (ExpVar acc)))))
                      (ExpIf (ExpBin (ExpInt 0) < (ExpVar sz)) (ExpApp (ExpApp (ExpVar loop) (ExpInt 0)) (ExpInt 0))
                             (ExpCon None))))
      (ExpCase (ExpVar arguments)
               ((RuleCase (PatListCons (PatVar s) PatWild)
                          (SCOPE ((BindExp (ExpApp (ExpVar print)
                                                   (ExpApp (ExpApp (ExpVar optionToString) (ExpVar intToString))
                                                           (ExpApp (ExpVar stringToInt) (ExpVar s))))))
                                 (ExpApp (ExpVar print) (ExpStr "\n")))) (RuleCase (PatCon Nil) (SCOPE () (ExpTuple))))))
